{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport styles from \"@/styles/fares.module.css\";\nimport { useRouter } from \"next/router\";\nimport Layout from \"@/components/layout\";\nimport FareCard from \"@/components/common/fareCard\";\nimport { countries } from \"utils/data\"; // firebase\n\nimport { collection, query, where, getDocs, limit, startAfter } from \"firebase/firestore\";\nimport { db } from \"@/config/firebaseConfig\";\nimport { convertString } from \"utils/helpers\";\nimport SyncAltIcon from \"@mui/icons-material/SyncAlt\";\nimport { Typography, Skeleton, ThemeProvider } from \"@mui/material\";\nimport InquiryForm from \"@/components/common/inquiryForm\";\nimport LoadingButton from \"@mui/lab/LoadingButton\";\nimport { theme } from \"@/styles/theme\";\nexport default function Fares() {\n  var router = useRouter();\n  var _router$query = router.query,\n      dest = _router$query.dest,\n      dept = _router$query.dept,\n      airlineCode = _router$query.airline;\n\n  var _useState = useState([]),\n      fares = _useState[0],\n      setFares = _useState[1];\n\n  var _useState2 = useState(null),\n      footerData = _useState2[0],\n      setFooterData = _useState2[1];\n\n  var _useState3 = useState(null),\n      airline = _useState3[0],\n      setAirline = _useState3[1];\n\n  var _useState4 = useState(false),\n      isEmpty = _useState4[0],\n      setIsEmpty = _useState4[1];\n\n  var _useState5 = useState(0),\n      skip = _useState5[0],\n      setSkip = _useState5[1];\n\n  var _useState6 = useState(),\n      lastDocu = _useState6[0],\n      setLastDocu = _useState6[1];\n\n  var _useState7 = useState(),\n      fetching = _useState7[0],\n      setFetching = _useState7[1];\n\n  var _useState8 = useState(false),\n      blockApi = _useState8[0],\n      setBlockApi = _useState8[1];\n\n  var getData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var arrOfData, q, querySnapshot, _arrOfData, _q, _querySnapshot, _arrOfData2, _q2, _querySnapshot2, _arrOfData3, _q3, _querySnapshot3, _arrOfData4, _q4, _querySnapshot4, _arrOfData5, _q5, _querySnapshot5, _arrOfData6, _q6, _querySnapshot6, _arrOfData7, _q7, _querySnapshot7, _arrOfData8, _q8, _querySnapshot8;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (blockApi) {\n                _context.next = 139;\n                break;\n              }\n\n              setFetching(true);\n\n              if (!(fares.length == 0)) {\n                _context.next = 95;\n                break;\n              }\n\n              if (!(airlineCode != \"all\")) {\n                _context.next = 49;\n                break;\n              }\n\n              if (!(dest != \"all\" && dept != \"all\")) {\n                _context.next = 19;\n                break;\n              }\n\n              arrOfData = [];\n              q = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), where(\"destAirport.airportCode\", \"==\", dest), where(\"airline.airlineCode\", \"==\", airlineCode), limit(10));\n              _context.next = 9;\n              return getDocs(q);\n\n            case 9:\n              querySnapshot = _context.sent;\n              setLastDocu(querySnapshot.docs[querySnapshot.docs.length - 1]);\n              querySnapshot.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFares(arrOfData);\n\n              if (arrOfData.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (arrOfData.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 19:\n              if (!(dept != \"all\")) {\n                _context.next = 34;\n                break;\n              }\n\n              _arrOfData = [];\n              _q = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), where(\"airline.airlineCode\", \"==\", airlineCode), limit(10));\n              _context.next = 24;\n              return getDocs(_q);\n\n            case 24:\n              _querySnapshot = _context.sent;\n              setLastDocu(_querySnapshot.docs[_querySnapshot.docs.length - 1]);\n\n              _querySnapshot.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares(_arrOfData);\n\n              if (_arrOfData.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 34:\n              if (!(dest != \"all\")) {\n                _context.next = 47;\n                break;\n              }\n\n              _arrOfData2 = [];\n              _q2 = query(collection(db, \"fares\"), where(\"destAirport.airportCode\", \"==\", dest), where(\"airline.airlineCode\", \"==\", airlineCode), limit(10));\n              _context.next = 39;\n              return getDocs(_q2);\n\n            case 39:\n              _querySnapshot2 = _context.sent;\n              setLastDocu(_querySnapshot2.docs[_querySnapshot2.docs.length - 1]);\n\n              _querySnapshot2.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData2.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares(_arrOfData2);\n\n              if (_arrOfData2.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData2.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 47:\n              _context.next = 93;\n              break;\n\n            case 49:\n              if (!(airlineCode == \"all\")) {\n                _context.next = 93;\n                break;\n              }\n\n              if (!(dest != \"all\" && dept != \"all\")) {\n                _context.next = 65;\n                break;\n              }\n\n              _arrOfData3 = [];\n              _q3 = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), where(\"destAirport.airportCode\", \"==\", dest), limit(10));\n              _context.next = 55;\n              return getDocs(_q3);\n\n            case 55:\n              _querySnapshot3 = _context.sent;\n              setLastDocu(_querySnapshot3.docs[_querySnapshot3.docs.length - 1]);\n\n              _querySnapshot3.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData3.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares(_arrOfData3);\n\n              if (_arrOfData3.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData3.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 65:\n              if (!(dept != \"all\")) {\n                _context.next = 80;\n                break;\n              }\n\n              _arrOfData4 = [];\n              _q4 = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), limit(10));\n              _context.next = 70;\n              return getDocs(_q4);\n\n            case 70:\n              _querySnapshot4 = _context.sent;\n              setLastDocu(_querySnapshot4.docs[_querySnapshot4.docs.length - 1]);\n\n              _querySnapshot4.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData4.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares(_arrOfData4);\n\n              if (_arrOfData4.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData4.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 80:\n              if (!(dest != \"all\")) {\n                _context.next = 93;\n                break;\n              }\n\n              _arrOfData5 = [];\n              _q5 = query(collection(db, \"fares\"), where(\"destAirport.airportCode\", \"==\", dest), limit(10));\n              _context.next = 85;\n              return getDocs(_q5);\n\n            case 85:\n              _querySnapshot5 = _context.sent;\n              setLastDocu(_querySnapshot5.docs[_querySnapshot5.docs.length - 1]);\n\n              _querySnapshot5.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData5.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares(_arrOfData5);\n\n              if (_arrOfData5.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData5.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 93:\n              _context.next = 139;\n              break;\n\n            case 95:\n              if (!(fares.length > 0)) {\n                _context.next = 139;\n                break;\n              }\n\n              if (!(dest != \"all\" && dept != \"all\")) {\n                _context.next = 111;\n                break;\n              }\n\n              _arrOfData6 = [];\n              _q6 = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), where(\"destAirport.airportCode\", \"==\", dest), startAfter(lastDocu), limit(10));\n              _context.next = 101;\n              return getDocs(_q6);\n\n            case 101:\n              _querySnapshot6 = _context.sent;\n              setLastDocu(_querySnapshot6.docs[_querySnapshot6.docs.length - 1]);\n\n              _querySnapshot6.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData6.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares([].concat(_toConsumableArray(fares), _arrOfData6));\n\n              if (_arrOfData6.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData6.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 111:\n              if (!(dept != \"all\")) {\n                _context.next = 126;\n                break;\n              }\n\n              _arrOfData7 = [];\n              _q7 = query(collection(db, \"fares\"), where(\"deptAirport.airportCode\", \"==\", dept), startAfter(lastDocu), limit(10));\n              _context.next = 116;\n              return getDocs(_q7);\n\n            case 116:\n              _querySnapshot7 = _context.sent;\n              setLastDocu(_querySnapshot7.docs[_querySnapshot7.docs.length - 1]);\n\n              _querySnapshot7.forEach(function (doc) {\n                // doc.data() is never undefined for query doc snapshots\n                _arrOfData7.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares([].concat(_toConsumableArray(fares), _arrOfData7));\n\n              if (_arrOfData7.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData7.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 126:\n              if (!(dest != \"all\")) {\n                _context.next = 139;\n                break;\n              }\n\n              _arrOfData8 = [];\n              _q8 = query(collection(db, \"fares\"), where(\"destAirport.airportCode\", \"==\", dest), startAfter(lastDocu), limit(10));\n              _context.next = 131;\n              return getDocs(_q8);\n\n            case 131:\n              _querySnapshot8 = _context.sent;\n              setLastDocu(_querySnapshot8.docs[_querySnapshot8.docs.length - 1]);\n\n              _querySnapshot8.forEach(function (doc) {\n                _arrOfData8.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares([].concat(_toConsumableArray(fares), _arrOfData8));\n\n              if (_arrOfData8.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (_arrOfData8.length < 10) {\n                setBlockApi(true);\n              }\n\n              setFetching(false);\n              return _context.abrupt(\"return\");\n\n            case 139:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getFooterData = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var index, arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              index = Math.floor(Math.random() * 13) + 1;\n              arrOfData = [];\n\n              if (!index) {\n                _context2.next = 9;\n                break;\n              }\n\n              q = query(collection(db, \"airlinesFooter\"), where(\"index\", \"==\", index.toString()));\n              _context2.next = 6;\n              return getDocs(q);\n\n            case 6:\n              querySnapshot = _context2.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFooterData(arrOfData[0]);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getFooterData() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getAirline = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var index, arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              index = Math.floor(Math.random() * 33) + 1;\n              arrOfData = [];\n\n              if (!index) {\n                _context3.next = 9;\n                break;\n              }\n\n              q = query(collection(db, \"airlines\"), where(\"index\", \"==\", index.toString()));\n              _context3.next = 6;\n              return getDocs(q);\n\n            case 6:\n              querySnapshot = _context3.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setAirline(arrOfData[0]);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getAirline() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (dept && dest) {\n      getData();\n      getFooterData();\n      getAirline(); // console.lxog(dept, dest);\n    }\n  }, [dest, dept]);\n  useEffect(function () {\n    if (dept && dest) {\n      getData();\n    }\n  }, [skip]);\n  return /*#__PURE__*/_jsx(Layout, {\n    title: \"Destinations\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.faresPage,\n      children: [fares.length > 0 && /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.banner,\n        children: [dept != \"all\" && dest == \"all\" && /*#__PURE__*/_jsx(\"h1\", {\n          style: {\n            marginRight: \"5px\"\n          },\n          children: \"From\"\n        }), /*#__PURE__*/_jsxs(\"h1\", {\n          children: [dept != \"all\" ? /*#__PURE__*/_jsx(_Fragment, {\n            children: convertString(fares[0].deptAirport.city)\n          }) : /*#__PURE__*/_jsx(_Fragment, {\n            children: \"To\"\n          }), dept != \"all\" && dest != \"all\" ? /*#__PURE__*/_jsx(\"span\", {\n            className: styles.banner__icon,\n            children: /*#__PURE__*/_jsx(SyncAltIcon, {})\n          }) : /*#__PURE__*/_jsx(_Fragment, {\n            children: \" \"\n          }), dest != \"all\" && /*#__PURE__*/_jsx(_Fragment, {\n            children: convertString(fares[0].destAirport.city)\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: !isEmpty ? styles.faresContainer : styles.displayNone,\n        children: fares.length > 0 ? /*#__PURE__*/_jsx(_Fragment, {\n          children: fares.map(function (fare, i) {\n            return /*#__PURE__*/_jsx(FareCard, {\n              data: fare\n            }, i);\n          })\n        }) : /*#__PURE__*/_jsx(_Fragment, {\n          children: Array(6).fill(true).map(function (item, i) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: styles.fareSkeletonForPC,\n                children: /*#__PURE__*/_jsx(Skeleton, {\n                  variant: \"rectangular\",\n                  width: 560,\n                  height: 215\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: styles.fareSkeletonForPhone,\n                children: /*#__PURE__*/_jsx(Skeleton, {\n                  variant: \"rectangular\",\n                  width: 280,\n                  height: 480\n                })\n              })]\n            }, i);\n          })\n        })\n      }), /*#__PURE__*/_jsx(ThemeProvider, {\n        theme: theme,\n        children: fares.length > 0 && /*#__PURE__*/_jsx(LoadingButton, {\n          sx: {\n            margin: \"1rem\"\n          },\n          loading: fetching,\n          disabled: blockApi,\n          onClick: function onClick() {\n            return setSkip(skip + 1);\n          },\n          variant: \"contained\",\n          children: blockApi ? \"No More\" : \"More\"\n        })\n      }), /*#__PURE__*/_jsx(_Fragment, {\n        children: isEmpty && /*#__PURE__*/_jsx(InquiryForm, {\n          h1: \"Send Inquiry\"\n        })\n      }), footerData && /*#__PURE__*/_jsx(\"div\", {\n        className: styles.airlineFooterContainer,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.airlineFooter,\n          children: [/*#__PURE__*/_jsx(\"h2\", {\n            children: footerData.mainTxt\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: styles.airlineFooter__cards,\n            children: footerData.cards.map(function (item, i) {\n              return /*#__PURE__*/_jsxs(\"div\", {\n                className: styles.airlineFooter__card,\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: styles.card__img,\n                  children: /*#__PURE__*/_jsx(\"img\", {\n                    src: item.img,\n                    alt: \"airlineFooter card img\"\n                  })\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: styles.card__txt,\n                  children: [/*#__PURE__*/_jsx(\"h4\", {\n                    children: item.heading\n                  }), /*#__PURE__*/_jsx(\"p\", {\n                    children: item.txt\n                  })]\n                })]\n              }, i);\n            })\n          })]\n        })\n      }), airline && /*#__PURE__*/_jsx(\"div\", {\n        className: styles.footerBanner,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: styles.bannerImg,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: airline.banner,\n            alt: \"\".concat(airline.name, \" image\")\n          })\n        })\n      })]\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}