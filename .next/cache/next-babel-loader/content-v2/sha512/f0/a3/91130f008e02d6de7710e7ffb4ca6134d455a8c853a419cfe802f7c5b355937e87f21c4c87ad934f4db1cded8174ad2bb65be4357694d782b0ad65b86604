{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"D:/Meta Melon Data/Schengen-Expert/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport styles from '@/styles/singleAirlineFares.module.css';\nimport { useRouter } from 'next/router';\nimport Layout from '../../../components/layout';\nimport FareCard from '@/components/common/fareCard';\nimport { countries } from 'utils/data'; // firebase\n\nimport { collection, query, where, getDocs, startAfter, limit } from 'firebase/firestore';\nimport { db } from '../../../config/firebaseConfig';\nimport { convertString } from '../../../utils/helpers';\nimport { Typography, Skeleton, ThemeProvider } from '@mui/material';\nimport LoadingButton from '@mui/lab/LoadingButton';\nimport InquiryForm from '@/components/common/inquiryForm';\nimport { theme } from '../../../styles/theme';\nimport Searchbar from '@/components/searchEngine';\nimport FilterSidebar from '@/components/filtersidebar';\nexport default function SingleAirline() {\n  var router = useRouter();\n  var airlineSlug = router.query.airlineSlug;\n\n  var _useState = useState([]),\n      fares = _useState[0],\n      setFares = _useState[1];\n\n  var _useState2 = useState(false),\n      isEmpty = _useState2[0],\n      setIsEmpty = _useState2[1];\n\n  var _useState3 = useState(null),\n      airline = _useState3[0],\n      setAirline = _useState3[1];\n\n  var _useState4 = useState(null),\n      footerData = _useState4[0],\n      setFooterData = _useState4[1];\n\n  var _useState5 = useState(0),\n      skip = _useState5[0],\n      setSkip = _useState5[1];\n\n  var _useState6 = useState(),\n      lastDocu = _useState6[0],\n      setLastDocu = _useState6[1];\n\n  var _useState7 = useState(),\n      fetching = _useState7[0],\n      setFetching = _useState7[1];\n\n  var _useState8 = useState(false),\n      blockApi = _useState8[0],\n      setBlockApi = _useState8[1];\n\n  var getData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var arrOfData, q, querySnapshot, _arrOfData, _q, _querySnapshot;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (blockApi) {\n                _context.next = 26;\n                break;\n              }\n\n              setFetching(true);\n\n              if (!(fares.length == 0)) {\n                _context.next = 15;\n                break;\n              }\n\n              arrOfData = [];\n              q = query(collection(db, 'fares'), where('airline.name', '==', airlineSlug), limit(10));\n              _context.next = 7;\n              return getDocs(q);\n\n            case 7:\n              querySnapshot = _context.sent;\n              setLastDocu(querySnapshot.docs[querySnapshot.docs.length - 1]);\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFares(arrOfData); // console.log(arrOfData);\n\n              if (arrOfData.length === 0) {\n                setIsEmpty(true);\n              }\n\n              if (arrOfData.length < 10) {\n                setBlockApi(true);\n              }\n\n              _context.next = 25;\n              break;\n\n            case 15:\n              if (!(fares.length > 0)) {\n                _context.next = 25;\n                break;\n              }\n\n              _arrOfData = [];\n              _q = query(collection(db, 'fares'), where('airline.name', '==', airlineSlug), startAfter(lastDocu), limit(10));\n              _context.next = 20;\n              return getDocs(_q);\n\n            case 20:\n              _querySnapshot = _context.sent;\n              setLastDocu(_querySnapshot.docs[_querySnapshot.docs.length - 1]);\n\n              _querySnapshot.forEach(function (doc) {\n                _arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n\n              setFares([].concat(_toConsumableArray(fares), _arrOfData));\n\n              if (_arrOfData.length < 10) {\n                setBlockApi(true);\n              }\n\n            case 25:\n              setFetching(false);\n\n            case 26:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getAirlineInfo = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              arrOfData = [];\n              q = query(collection(db, 'airlines'), where('name', '==', airlineSlug));\n              _context2.next = 4;\n              return getDocs(q);\n\n            case 4:\n              querySnapshot = _context2.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setAirline(arrOfData[0]);\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getAirlineInfo() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getFooterData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              arrOfData = [];\n              q = query(collection(db, 'airlinesFooter'), where('name', '==', airlineSlug));\n              _context3.next = 4;\n              return getDocs(q);\n\n            case 4:\n              querySnapshot = _context3.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFooterData(arrOfData[0]); // console.log(arrOfData[0]);\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getFooterData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (airlineSlug) {\n      getData();\n      getAirlineInfo();\n      getFooterData();\n    }\n  }, [airlineSlug]);\n  useEffect(function () {\n    if (airlineSlug) {\n      getData();\n    }\n  }, [skip]); // console.log(airline);\n  // console.log(footerData);\n  // console.log(fares);\n\n  var getDepartureFilterData = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(code) {\n      var arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              arrOfData = [];\n              q = query(collection(db, 'fares'), where('deptCountry.code', '==', code));\n              _context4.next = 4;\n              return getDocs(q);\n\n            case 4:\n              querySnapshot = _context4.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFares([].concat(arrOfData));\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function getDepartureFilterData(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var getDestinationFilterData = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(code) {\n      var arrOfData, q, querySnapshot;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              arrOfData = [];\n\n              if (code.length > 0) {\n                q = query(collection(db, 'fares'), where('airline.name', '==', airlineSlug), where('destCountry.code', 'in', code));\n              } else {\n                q = query(collection(db, 'fares'), where('airline.name', '==', airlineSlug));\n              }\n\n              _context5.next = 4;\n              return getDocs(q);\n\n            case 4:\n              querySnapshot = _context5.sent;\n              querySnapshot.forEach(function (doc) {\n                arrOfData.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n                  _id: doc.id\n                }));\n              });\n              setFares([].concat(arrOfData));\n\n            case 7:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function getDestinationFilterData(_x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(Layout, {\n    title: 'Airlines',\n    children: [/*#__PURE__*/_jsx(ThemeProvider, {\n      theme: theme\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.faresPage,\n      children: [airline ? /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: styles.bannerImg,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: airline.banner,\n            alt: \"\".concat(airline.name, \" image\")\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          style: {\n            marginTop: '2rem'\n          },\n          children: /*#__PURE__*/_jsx(Searchbar, {})\n        })]\n      }) : /*#__PURE__*/_jsx(_Fragment, {\n        children: airlineSlug && /*#__PURE__*/_jsx(\"div\", {\n          className: styles.bannerTxt,\n          children: /*#__PURE__*/_jsx(\"h1\", {\n            children: convertString(airlineSlug)\n          })\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.cardandfiltercontainer,\n        children: [/*#__PURE__*/_jsx(FilterSidebar, {\n          getDepartureFilterData: getDepartureFilterData,\n          getDestinationFilterData: getDestinationFilterData\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.faresContainer,\n          children: fares.length > 0 ? /*#__PURE__*/_jsx(_Fragment, {\n            children: fares.length > 0 && fares.map(function (fare, i) {\n              return /*#__PURE__*/_jsx(FareCard, {\n                data: fare,\n                index: i\n              }, i);\n            })\n          }) : fetching === true ? Array(6).fill(true).map(function (item, i) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: styles.fareSkeletonForPC,\n                children: /*#__PURE__*/_jsx(Skeleton, {\n                  variant: \"rectangular\",\n                  width: 560,\n                  height: 215\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: styles.fareSkeletonForPhone,\n                children: /*#__PURE__*/_jsx(Skeleton, {\n                  variant: \"rectangular\",\n                  width: 280,\n                  height: 480\n                })\n              })]\n            }, i);\n          }) : isEmpty && /*#__PURE__*/_jsx(\"h1\", {\n            children: \"No Record Found\"\n          })\n        })]\n      }), /*#__PURE__*/_jsx(ThemeProvider, {\n        theme: theme,\n        children: fares.length > 0 && /*#__PURE__*/_jsx(LoadingButton, {\n          sx: {\n            margin: '1rem'\n          },\n          loading: fetching,\n          disabled: blockApi,\n          onClick: function onClick() {\n            return setSkip(skip + 1);\n          },\n          variant: \"contained\",\n          children: blockApi ? 'No More' : 'More'\n        })\n      }), /*#__PURE__*/_jsx(_Fragment, {\n        children: isEmpty && /*#__PURE__*/_jsx(InquiryForm, {\n          h1: \"Send Inquiry\"\n        })\n      })]\n    }), footerData && /*#__PURE__*/_jsx(\"div\", {\n      className: styles.airlineFooterContainer,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.airlineFooter,\n        children: [/*#__PURE__*/_jsx(\"h2\", {\n          children: footerData.mainTxt\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.airlineFooter__cards,\n          children: footerData.cards.map(function (item, i) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.airlineFooter__card,\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: styles.card__img,\n                children: /*#__PURE__*/_jsx(\"img\", {\n                  src: item.img,\n                  alt: \"airlineFooter card img\"\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: styles.card__txt,\n                children: [/*#__PURE__*/_jsx(\"h4\", {\n                  children: item.heading\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  children: item.txt\n                })]\n              })]\n            }, i);\n          })\n        })]\n      })\n    }), airline && /*#__PURE__*/_jsx(\"div\", {\n      className: styles.footerBanner,\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: styles.bannerImg,\n        children: /*#__PURE__*/_jsx(\"img\", {\n          src: airline.banner,\n          alt: \"\".concat(airline.name, \" image\")\n        })\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}